# Spreadsheet
Электронная таблица

(дипломный проект на C++ в рамках курса Яндекс Практикум)

## Описание
Spreadsheet - это бэкенд-реализация электронной таблицы. Поддерживает текстовые и числовые ячейки, основные арифметические операции, а также ссылки на другие ячейки. 

Пример:
```
    auto sheet = CreateSheet();
    sheet->SetCell("A1"_pos, "2");
    sheet->SetCell("A2"_pos, "=33-2*(110-5)/7");
    sheet->SetCell("A3"_pos, "=A1*2");
    sheet->SetCell("A4"_pos, "=A3+1");
    sheet->SetCell("A5"_pos, "=A1+A2+A3+A4");

    ASSERT_EQUAL(std::get<std::double>(sheet->GetCell("A5"_pos)->GetValue()), 15);
```

Реализована поддержка исключений:
  + #DIV0! - деление на ноль
  + #VALUE! - операнд содержит текстовое значение вместо числа
  + #REF! - ссылочная позиция ячейки выходит за пределы возможного размера листа

Реализована циклическая проверка зависимостей ссылок. В случае обнаружение циклической зависимости будет выброшено исключение CircularDependencyException. 

Пример:
```
    sheet->SetCell("A1"_pos, "=A2");
    sheet->SetCell("A2"_pos, "=A3");
    sheet->SetCell("A3"_pos, "=A1");
```

## Применяемые навыки

ООП, полиморфизм, шаблоны, лямбда-функции, стандартные алгоритмы, абстрактное синтаксическое дерево (AST).

## Сборка

Для парсинга формул используется генератор [ANTLR](https://www.antlr.org/). Правила грамматики формул находятся в файле **Formula.g4**.

Чтобы сгенерировать исполнительные файлы, необходимо выполнить следующую команду:
```
    antlr -Dlanguage=Cpp Formula.g4
```

Для быстрой сборки с помощью CMAKE включён файл CMakeLists.txt.
